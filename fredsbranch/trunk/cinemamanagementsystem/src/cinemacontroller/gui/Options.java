/*
 * Options2.java
 *
 * Created on 2 avril 2009, 04:12
 */

package cinemacontroller.gui;

import java.sql.ResultSet;
import java.sql.SQLException;

import javax.swing.DefaultComboBoxModel;
import javax.swing.JOptionPane;
import javax.swing.JTextField;

import databasecontroller.MySqlController;

/**
 *
 * @author  Frédéric
 */
public class Options extends javax.swing.JFrame {

	private static final long serialVersionUID = 0L;
    /** Creates new form Options2 */
    public Options() {
        initComponents();
        this.setLocationRelativeTo(null);
        this.setVisible(true);
    }

    /** This method is called from within the constructor to
     * initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is
     * always regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">
    private void initComponents() {

        jPanel1 = new javax.swing.JPanel();
        jLabel1 = new javax.swing.JLabel();
        jScrollPane3 = new javax.swing.JScrollPane();
        jTextPane_date_description = new javax.swing.JTextPane();
        jTextField1 = new javax.swing.JTextField();
        jLabel10 = new javax.swing.JLabel();
        jTextField2 = new javax.swing.JTextField();
        jLabel3 = new javax.swing.JLabel();
        jTextField4 = new javax.swing.JTextField();
        jLabel6 = new javax.swing.JLabel();
        jLabel5 = new javax.swing.JLabel();
        jTextField3 = new javax.swing.JTextField();
        jLabel7 = new javax.swing.JLabel();
        jTextField5 = new javax.swing.JTextField();
        jTextField6 = new javax.swing.JTextField();
        jLabel8 = new javax.swing.JLabel();
        jButton1 = new javax.swing.JButton();
        jButton2 = new javax.swing.JButton();

        setDefaultCloseOperation(javax.swing.WindowConstants.DISPOSE_ON_CLOSE);
        setTitle("Options - Multiplex Manager");
        setIconImage(getToolkit().getImage(getClass().getResource("/cinemacontroller/gui/icons/options.png")));

        jPanel1.setBackground(new java.awt.Color(24, 24, 24));

        jLabel1.setFont(new java.awt.Font("Tahoma", 1, 11));
        jLabel1.setForeground(new java.awt.Color(255, 255, 255));
        jLabel1.setText("Options");

        jScrollPane3.setBorder(null);

        jTextPane_date_description.setBackground(new java.awt.Color(24, 24, 24));
        jTextPane_date_description.setEditable(false);
        jTextPane_date_description.setForeground(new java.awt.Color(255, 255, 255));
        jTextPane_date_description.setText("This window allows to change some parameters for the automatic rotation.");
        jScrollPane3.setViewportView(jTextPane_date_description);

        javax.swing.GroupLayout jPanel1Layout = new javax.swing.GroupLayout(jPanel1);
        jPanel1.setLayout(jPanel1Layout);
        jPanel1Layout.setHorizontalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel1Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jScrollPane3, javax.swing.GroupLayout.PREFERRED_SIZE, 172, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel1, javax.swing.GroupLayout.DEFAULT_SIZE, 172, Short.MAX_VALUE))
                .addContainerGap())
        );
        jPanel1Layout.setVerticalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel1Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jLabel1)
                .addGap(18, 18, 18)
                .addComponent(jScrollPane3, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(162, Short.MAX_VALUE))
        );

        jTextField1.setHorizontalAlignment(javax.swing.JTextField.CENTER);

        jLabel10.setText("Expected audience start value");
        jLabel10.setToolTipText("This value is the basic multiplier for expected audience calculation.");

        jTextField2.setHorizontalAlignment(javax.swing.JTextField.CENTER);

        jLabel3.setText("Minus for period additional film");
        jLabel3.setToolTipText("<html>It is a multiplier applied to the calculation of expected audience.<br/>It is applied to the films selected in addition to a period film list which not contains the minimum of films required.</html>");

        jTextField4.setHorizontalAlignment(javax.swing.JTextField.CENTER);

        jLabel6.setText("Minus for previous week films");
        jLabel6.setToolTipText("It is applied for each week (with a limit of two weeks) between release date and screening week of the film.");

        jLabel5.setText("Minimum Screening Films");
        jLabel5.setToolTipText("The minimum of screening films for a week.");
        jLabel5.setAutoscrolls(true);

        jTextField3.setHorizontalAlignment(javax.swing.JTextField.CENTER);
        jTextField3.setInheritsPopupMenu(true);

        jLabel7.setText("Minimum Films");
        jLabel7.setToolTipText("Minimum of films choosen into the database for a week. This value must be greater or equals to 'Minimum Screening Films'.");
        jLabel7.setAutoscrolls(true);

        jTextField5.setHorizontalAlignment(javax.swing.JTextField.CENTER);
        jTextField5.setInheritsPopupMenu(true);

        jTextField6.setHorizontalAlignment(javax.swing.JTextField.CENTER);
        jTextField6.setInheritsPopupMenu(true);

        jLabel8.setText("Minimum Screens Used");
        jLabel8.setToolTipText("Minimum of screens open at the same time. This value must be greater or equals to 'Minimum Screening Films'.");
        jLabel8.setAutoscrolls(true);

        jButton1.setText("Apply");
        jButton1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
            	jButton1ActionPerformed(evt);
            }
        });

        jButton2.setText("Close");
        jButton2.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
            	jButton2ActionPerformed(evt);
            }
        });

        MySqlController connection;

		try {
			
			connection = MySqlController.getInstance();
			ResultSet r= connection.getData("SELECT VALUE FROM INDEXES WHERE NAME ='START_VALUE'");

			if(r.next()) {
		        jTextField1.setText(r.getString(1));
			}
			
			r= connection.getData("SELECT VALUE FROM INDEXES WHERE NAME ='ADDITIONAL_MOVIE_MALUS'");

			if(r.next()) {
				jTextField2.setText(r.getString(1));
			}
			
			r= connection.getData("SELECT VALUE FROM INDEXES WHERE NAME ='PREVIOUS_PERIOD_MALUS'");

			if(r.next()) {
				jTextField4.setText(r.getString(1));
			}
			
			r= connection.getData("SELECT VALUE FROM INDEXES WHERE NAME ='MINIMUM_SCREENING_FILM'");

			if(r.next()) {
				jTextField3.setText(r.getString(1));
			}
			
			r= connection.getData("SELECT VALUE FROM INDEXES WHERE NAME ='MINIMUM_FILM'");

			if(r.next()) {
				jTextField5.setText(r.getString(1));
			}
			
			r= connection.getData("SELECT VALUE FROM INDEXES WHERE NAME ='MINIMUM_SCREEN_USE'");

			if(r.next()) {
				jTextField6.setText(r.getString(1));
			}
			
		} catch (SQLException e) {
			e.printStackTrace();
		}

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
        getContentPane().setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addComponent(jPanel1, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                    .addGroup(layout.createSequentialGroup()
                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(layout.createSequentialGroup()
                                .addGap(19, 19, 19)
                                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                    .addComponent(jLabel5)
                                    .addComponent(jTextField3, javax.swing.GroupLayout.PREFERRED_SIZE, 115, javax.swing.GroupLayout.PREFERRED_SIZE))
                                .addGap(28, 28, 28)
                                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                    .addComponent(jLabel7)
                                    .addComponent(jTextField5, javax.swing.GroupLayout.PREFERRED_SIZE, 115, javax.swing.GroupLayout.PREFERRED_SIZE))
                                .addGap(33, 33, 33)
                                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                    .addComponent(jTextField6, javax.swing.GroupLayout.PREFERRED_SIZE, 115, javax.swing.GroupLayout.PREFERRED_SIZE)
                                    .addComponent(jLabel8))
                                .addGap(105, 105, 105))
                            .addGroup(layout.createSequentialGroup()
                                .addGap(18, 18, 18)
                                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                    .addComponent(jTextField1, javax.swing.GroupLayout.PREFERRED_SIZE, 115, javax.swing.GroupLayout.PREFERRED_SIZE)
                                    .addComponent(jLabel10))
                                .addGap(367, 367, 367))
                            .addGroup(layout.createSequentialGroup()
                                .addGap(18, 18, 18)
                                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                    .addComponent(jTextField2, javax.swing.GroupLayout.PREFERRED_SIZE, 115, javax.swing.GroupLayout.PREFERRED_SIZE)
                                    .addComponent(jLabel3))
                                .addGap(27, 27, 27)
                                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                    .addComponent(jTextField4, javax.swing.GroupLayout.PREFERRED_SIZE, 115, javax.swing.GroupLayout.PREFERRED_SIZE)
                                    .addComponent(jLabel6))
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)))
                        .addContainerGap(53, Short.MAX_VALUE))
                    .addGroup(layout.createSequentialGroup()
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(jButton2)
                        .addGap(18, 18, 18)
                        .addComponent(jButton1)
                        .addContainerGap())))
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jPanel1, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
            .addGroup(layout.createSequentialGroup()
                .addGap(29, 29, 29)
                .addComponent(jLabel10)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addComponent(jTextField1, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 20, Short.MAX_VALUE)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(layout.createSequentialGroup()
                        .addComponent(jLabel3)
                        .addGap(13, 13, 13)
                        .addComponent(jTextField2, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(1, 1, 1))
                    .addGroup(layout.createSequentialGroup()
                        .addGap(28, 28, 28)
                        .addComponent(jTextField4, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addComponent(jLabel6))
                .addGap(18, 18, 18)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                    .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                        .addGroup(layout.createSequentialGroup()
                            .addComponent(jLabel5, javax.swing.GroupLayout.PREFERRED_SIZE, 15, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                            .addComponent(jTextField3, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addGroup(layout.createSequentialGroup()
                            .addGap(1, 1, 1)
                            .addComponent(jLabel7)
                            .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                            .addComponent(jTextField5, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)))
                    .addGroup(layout.createSequentialGroup()
                        .addComponent(jLabel8)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(jTextField6, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addGap(18, 18, 18)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jButton1)
                    .addComponent(jButton2))
                .addContainerGap())
        );

        pack();
    }// </editor-fold>
    
    public boolean isInt(JTextField jTextField){
    	boolean state = false;
    	
    	if(jTextField.getText().matches("[0-9]+")){
    		state =true;
    	}

    	return state;
    }
    
    public boolean isFloat(JTextField jTextField){
    	boolean state = false;
    	
    	if(jTextField.getText().matches("^[0-9]+\\.[0-9]+")){
    		state =true;
    	}

    	return state;
    }
    
    public boolean isEmpty(JTextField jTextField){
    	boolean state = false;
    	
    	if(jTextField.getText().isEmpty()){
    		state =true;
    	}

    	return state;
    }
    
    public void updateValues(){
    	
        MySqlController connection;

		try {
			
			connection = MySqlController.getInstance();
			connection.putData("UPDATE INDEXES SET VALUE='"+jTextField1.getText()+"' WHERE NAME ='START_VALUE'");
			connection.putData("UPDATE INDEXES SET VALUE='"+jTextField2.getText()+"' WHERE NAME ='ADDITIONAL_MOVIE_MALUS'");
			connection.putData("UPDATE INDEXES SET VALUE='"+jTextField4.getText()+"' WHERE NAME ='PREVIOUS_PERIOD_MALUS'");
			connection.putData("UPDATE INDEXES SET VALUE='"+jTextField3.getText()+"' WHERE NAME ='MINIMUM_SCREENING_FILM'");
			connection.putData("UPDATE INDEXES SET VALUE='"+jTextField5.getText()+"' WHERE NAME ='MINIMUM_FILM'");
			connection.putData("UPDATE INDEXES SET VALUE='"+jTextField6.getText()+"' WHERE NAME ='MINIMUM_SCREEN_USE'");
			
			JOptionPane.showMessageDialog(null, "Data updated successfully.", "Options", JOptionPane.INFORMATION_MESSAGE);
			this.dispose();
			
		} catch (SQLException e) {
			e.printStackTrace();
		}
    	
    }
    
    
 
private void jButton1ActionPerformed(java.awt.event.ActionEvent evt) {
	
    
	if( (isInt(jTextField1) && !isEmpty(jTextField1)) && ((isInt(jTextField2) || isFloat(jTextField2)) && !isEmpty(jTextField2))    
		&& (isInt(jTextField3) && !isEmpty(jTextField3)) && ((isFloat(jTextField4)) && !isEmpty(jTextField4))
	    && (isInt(jTextField5) && !isEmpty(jTextField5)) && (isInt(jTextField6) && !isEmpty(jTextField6))
	
	){
		
		if(jTextField5.getText().compareTo(jTextField3.getText()) >= 0){
			
			if(jTextField6.getText().compareTo(jTextField3.getText()) >= 0){
				
				updateValues();
				
			}
			else{
				JOptionPane.showMessageDialog(null, "Please the value of 'Minimum Screens Used' must be greater or equals to 'Minimum Screening Films'", "Invalid Data", JOptionPane.WARNING_MESSAGE);
			}
		}
		else{
			JOptionPane.showMessageDialog(null, "Please the value of 'Minimum Films' must be greater or equals to 'Minimum Screening Films'", "Invalid Data", JOptionPane.WARNING_MESSAGE);
		}
	}
	else{
		JOptionPane.showMessageDialog(null, "Please all data must be a positive value (float for minuses and integer for the others).", "Invalid Data", JOptionPane.WARNING_MESSAGE);
	}
}

private void jButton2ActionPerformed(java.awt.event.ActionEvent evt) {
this.dispose();
}


    // Variables declaration - do not modify
    private javax.swing.JButton jButton1;
    private javax.swing.JButton jButton2;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel10;
    private javax.swing.JLabel jLabel3;
    private javax.swing.JLabel jLabel5;
    private javax.swing.JLabel jLabel6;
    private javax.swing.JLabel jLabel7;
    private javax.swing.JLabel jLabel8;
    private javax.swing.JPanel jPanel1;
    private javax.swing.JScrollPane jScrollPane3;
    private javax.swing.JTextField jTextField1;
    private javax.swing.JTextField jTextField2;
    private javax.swing.JTextField jTextField3;
    private javax.swing.JTextField jTextField4;
    private javax.swing.JTextField jTextField5;
    private javax.swing.JTextField jTextField6;
    private javax.swing.JTextPane jTextPane_date_description;
    // End of variables declaration

}
